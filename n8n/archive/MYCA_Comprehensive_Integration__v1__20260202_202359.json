{
  "updatedAt": "2025-12-17T05:30:00.000Z",
  "createdAt": "2026-01-27T06:13:14.060Z",
  "id": "ABxL2tJ7YxYox2jE",
  "name": "MYCA Comprehensive Integration",
  "description": null,
  "active": true,
  "isArchived": false,
  "nodes": [
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "myca-command",
        "responseMode": "responseNode",
        "options": {}
      },
      "id": "webhook-trigger",
      "name": "Webhook Trigger",
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 1.1,
      "position": [
        250,
        300
      ]
    },
    {
      "parameters": {
        "content": "={{ $json.body.command || $json.query.command }}",
        "options": {}
      },
      "id": "extract-command",
      "name": "Extract Command",
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        450,
        300
      ]
    },
    {
      "parameters": {
        "conditions": {
          "string": [
            {
              "value1": "={{ $json.content }}",
              "operation": "contains",
              "value2": "agent"
            }
          ]
        }
      },
      "id": "route-decision",
      "name": "Route Decision",
      "type": "n8n-nodes-base.if",
      "typeVersion": 2,
      "position": [
        650,
        300
      ]
    },
    {
      "parameters": {
        "url": "http://mas-orchestrator:8000/agents",
        "authentication": "none",
        "options": {}
      },
      "id": "list-agents",
      "name": "List MAS Agents",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        850,
        200
      ]
    },
    {
      "parameters": {
        "url": "http://mas-orchestrator:8000/voice/orchestrator/chat",
        "authentication": "none",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={{ { \"message\": $json.content, \"want_audio\": false } }}",
        "options": {}
      },
      "id": "orchestrator-chat",
      "name": "MYCA Orchestrator Chat",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        850,
        400
      ]
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "feedback-id",
              "name": "conversation_id",
              "value": "={{ $json.conversation_id }}",
              "type": "string"
            },
            {
              "id": "response",
              "name": "response",
              "value": "={{ $json.response_text }}",
              "type": "string"
            },
            {
              "id": "timestamp",
              "name": "timestamp",
              "value": "={{ $now }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "id": "format-response",
      "name": "Format Response",
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        1050,
        400
      ]
    },
    {
      "parameters": {
        "url": "http://mas-orchestrator:8000/voice/feedback",
        "authentication": "none",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={{ { \"conversation_id\": $json.conversation_id, \"agent_name\": \"Orchestrator\", \"transcript\": $json.content, \"response_text\": $json.response, \"rating\": 4, \"success\": true, \"notes\": \"Auto-logged by n8n\" } }}",
        "options": {}
      },
      "id": "store-feedback",
      "name": "Store Feedback in MAS",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        1250,
        500
      ]
    },
    {
      "parameters": {
        "respondWith": "json",
        "responseBody": "={{ { \"status\": \"success\", \"conversation_id\": $json.conversation_id, \"response\": $json.response, \"logged\": true } }}",
        "options": {}
      },
      "id": "webhook-response",
      "name": "Webhook Response",
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.1,
      "position": [
        1450,
        300
      ]
    },
    {
      "parameters": {
        "conditions": {
          "string": [
            {
              "value1": "={{ $json.body.action || $json.query.action }}",
              "operation": "equals",
              "value2": "sms"
            }
          ]
        }
      },
      "id": "check-sms-action",
      "name": "Check SMS Action",
      "type": "n8n-nodes-base.if",
      "typeVersion": 2,
      "position": [
        1050,
        600
      ]
    },
    {
      "parameters": {
        "url": "http://mas-orchestrator:8000/twilio/sms/send",
        "authentication": "none",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={{ { \"to\": $json.body.phone_number || $json.query.phone_number, \"message\": $json.response || $json.response_text } }}",
        "options": {}
      },
      "id": "send-sms",
      "name": "Send SMS via Twilio",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        1250,
        550
      ]
    },
    {
      "parameters": {
        "conditions": {
          "string": [
            {
              "value1": "={{ $json.body.action || $json.query.action }}",
              "operation": "equals",
              "value2": "voice"
            }
          ]
        }
      },
      "id": "check-voice-action",
      "name": "Check Voice Action",
      "type": "n8n-nodes-base.if",
      "typeVersion": 2,
      "position": [
        1050,
        750
      ]
    },
    {
      "parameters": {
        "url": "http://mas-orchestrator:8000/twilio/voice/message",
        "authentication": "none",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={{ { \"to\": $json.body.phone_number || $json.query.phone_number, \"message\": $json.response || $json.response_text, \"voice\": \"alice\" } }}",
        "options": {}
      },
      "id": "send-voice",
      "name": "Send Voice Message via Twilio",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        1250,
        700
      ]
    },
    {
      "parameters": {
        "content": "=Zapier MCP integration available at:\nhttps://mcp.zapier.com/api/mcp/s/MmM5MmJkNDgtMDI5MC00ZGZhLWFlOGItYzM1MDQ4YTNkOWU0OmY5OWI4ZGYxLTAxNTgtNGZmOC05MDRkLTZlMmQzMzNlM2ViOQ==/mcp\n\nUse HTTP Request node to call Zapier actions.\nExample: POST with proper auth headers to trigger Zaps.",
        "height": 80,
        "width": 400,
        "color": 7
      },
      "id": "zapier-note",
      "name": "Zapier MCP Info",
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        250,
        600
      ]
    },
    {
      "parameters": {
        "content": "=This workflow demonstrates:\n- Webhook trigger for external/UI calls\n- MAS agent listing\n- Orchestrator chat with context\n- n8n Data Table logging\n- Feedback loop to MAS\n- Twilio SMS/voice integration\n- Ready for Zapier MCP integration\n\nTo extend:\n1. Add HTTP Request nodes for Zapier MCP actions\n2. Add Proxmox/UniFi integration calls\n3. Add conditional routing to specific agents\n4. Add voice transcription branch\n5. Use action=sms or action=voice in webhook body to trigger Twilio",
        "height": 200,
        "width": 400,
        "color": 4
      },
      "id": "workflow-docs",
      "name": "Workflow Documentation",
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        650,
        600
      ]
    }
  ],
  "connections": {
    "webhook-trigger": {
      "main": [
        [
          {
            "node": "extract-command",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "extract-command": {
      "main": [
        [
          {
            "node": "route-decision",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "route-decision": {
      "main": [
        [
          {
            "node": "list-agents",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "orchestrator-chat",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "list-agents": {
      "main": [
        [
          {
            "node": "format-response",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "orchestrator-chat": {
      "main": [
        [
          {
            "node": "format-response",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "format-response": {
      "main": [
        [
          {
            "node": "store-feedback",
            "type": "main",
            "index": 0
          },
          {
            "node": "check-sms-action",
            "type": "main",
            "index": 0
          },
          {
            "node": "check-voice-action",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "check-sms-action": {
      "main": [
        [
          {
            "node": "send-sms",
            "type": "main",
            "index": 0
          }
        ],
        []
      ]
    },
    "check-voice-action": {
      "main": [
        [
          {
            "node": "send-voice",
            "type": "main",
            "index": 0
          }
        ],
        []
      ]
    },
    "send-sms": {
      "main": [
        [
          {
            "node": "webhook-response",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "send-voice": {
      "main": [
        [
          {
            "node": "webhook-response",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "store-feedback": {
      "main": [
        [
          {
            "node": "webhook-response",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "settings": {
    "executionOrder": "v1"
  },
  "staticData": null,
  "meta": null,
  "pinData": {},
  "versionId": "1044ae2b-0e0c-42a4-845e-9970e0b51c05",
  "activeVersionId": "1044ae2b-0e0c-42a4-845e-9970e0b51c05",
  "versionCounter": 7,
  "triggerCount": 1,
  "shared": [
    {
      "updatedAt": "2026-01-27T06:13:14.068Z",
      "createdAt": "2026-01-27T06:13:14.068Z",
      "role": "workflow:owner",
      "workflowId": "ABxL2tJ7YxYox2jE",
      "projectId": "UVnbpKaWHGjwcMgw",
      "project": {
        "updatedAt": "2026-01-27T18:06:19.407Z",
        "createdAt": "2026-01-27T02:07:38.443Z",
        "id": "UVnbpKaWHGjwcMgw",
        "name": "Morgan Mushroom <morgan@mycosoft.org>",
        "type": "personal",
        "icon": null,
        "description": null,
        "creatorId": "5a61112a-4aeb-40a2-a504-bd67afa8e55b",
        "projectRelations": [
          {
            "updatedAt": "2026-01-27T02:07:38.443Z",
            "createdAt": "2026-01-27T02:07:38.443Z",
            "userId": "5a61112a-4aeb-40a2-a504-bd67afa8e55b",
            "projectId": "UVnbpKaWHGjwcMgw",
            "user": {
              "updatedAt": "2026-02-02T20:23:44.000Z",
              "createdAt": "2026-01-27T02:07:37.832Z",
              "id": "5a61112a-4aeb-40a2-a504-bd67afa8e55b",
              "email": "morgan@mycosoft.org",
              "firstName": "Morgan",
              "lastName": "Mushroom",
              "personalizationAnswers": {
                "version": "v4",
                "personalization_survey_submitted_at": "2026-01-27T18:07:20.521Z",
                "personalization_survey_n8n_version": "2.4.6"
              },
              "settings": {
                "userActivated": false
              },
              "disabled": false,
              "mfaEnabled": false,
              "lastActiveAt": "2026-02-02",
              "isPending": false
            }
          }
        ]
      }
    }
  ],
  "tags": [],
  "activeVersion": {
    "updatedAt": "2026-01-27T06:13:14.071Z",
    "createdAt": "2026-01-27T06:13:14.071Z",
    "versionId": "1044ae2b-0e0c-42a4-845e-9970e0b51c05",
    "workflowId": "ABxL2tJ7YxYox2jE",
    "nodes": [
      {
        "parameters": {
          "httpMethod": "POST",
          "path": "myca-command",
          "responseMode": "responseNode",
          "options": {}
        },
        "id": "webhook-trigger",
        "name": "Webhook Trigger",
        "type": "n8n-nodes-base.webhook",
        "typeVersion": 1.1,
        "position": [
          250,
          300
        ]
      },
      {
        "parameters": {
          "content": "={{ $json.body.command || $json.query.command }}",
          "options": {}
        },
        "id": "extract-command",
        "name": "Extract Command",
        "type": "n8n-nodes-base.set",
        "typeVersion": 3.4,
        "position": [
          450,
          300
        ]
      },
      {
        "parameters": {
          "conditions": {
            "string": [
              {
                "value1": "={{ $json.content }}",
                "operation": "contains",
                "value2": "agent"
              }
            ]
          }
        },
        "id": "route-decision",
        "name": "Route Decision",
        "type": "n8n-nodes-base.if",
        "typeVersion": 2,
        "position": [
          650,
          300
        ]
      },
      {
        "parameters": {
          "url": "http://mas-orchestrator:8000/agents",
          "authentication": "none",
          "options": {}
        },
        "id": "list-agents",
        "name": "List MAS Agents",
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.2,
        "position": [
          850,
          200
        ]
      },
      {
        "parameters": {
          "url": "http://mas-orchestrator:8000/voice/orchestrator/chat",
          "authentication": "none",
          "sendBody": true,
          "specifyBody": "json",
          "jsonBody": "={{ { \"message\": $json.content, \"want_audio\": false } }}",
          "options": {}
        },
        "id": "orchestrator-chat",
        "name": "MYCA Orchestrator Chat",
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.2,
        "position": [
          850,
          400
        ]
      },
      {
        "parameters": {
          "assignments": {
            "assignments": [
              {
                "id": "feedback-id",
                "name": "conversation_id",
                "value": "={{ $json.conversation_id }}",
                "type": "string"
              },
              {
                "id": "response",
                "name": "response",
                "value": "={{ $json.response_text }}",
                "type": "string"
              },
              {
                "id": "timestamp",
                "name": "timestamp",
                "value": "={{ $now }}",
                "type": "string"
              }
            ]
          },
          "options": {}
        },
        "id": "format-response",
        "name": "Format Response",
        "type": "n8n-nodes-base.set",
        "typeVersion": 3.4,
        "position": [
          1050,
          400
        ]
      },
      {
        "parameters": {
          "url": "http://mas-orchestrator:8000/voice/feedback",
          "authentication": "none",
          "sendBody": true,
          "specifyBody": "json",
          "jsonBody": "={{ { \"conversation_id\": $json.conversation_id, \"agent_name\": \"Orchestrator\", \"transcript\": $json.content, \"response_text\": $json.response, \"rating\": 4, \"success\": true, \"notes\": \"Auto-logged by n8n\" } }}",
          "options": {}
        },
        "id": "store-feedback",
        "name": "Store Feedback in MAS",
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.2,
        "position": [
          1250,
          500
        ]
      },
      {
        "parameters": {
          "respondWith": "json",
          "responseBody": "={{ { \"status\": \"success\", \"conversation_id\": $json.conversation_id, \"response\": $json.response, \"logged\": true } }}",
          "options": {}
        },
        "id": "webhook-response",
        "name": "Webhook Response",
        "type": "n8n-nodes-base.respondToWebhook",
        "typeVersion": 1.1,
        "position": [
          1450,
          300
        ]
      },
      {
        "parameters": {
          "conditions": {
            "string": [
              {
                "value1": "={{ $json.body.action || $json.query.action }}",
                "operation": "equals",
                "value2": "sms"
              }
            ]
          }
        },
        "id": "check-sms-action",
        "name": "Check SMS Action",
        "type": "n8n-nodes-base.if",
        "typeVersion": 2,
        "position": [
          1050,
          600
        ]
      },
      {
        "parameters": {
          "url": "http://mas-orchestrator:8000/twilio/sms/send",
          "authentication": "none",
          "sendBody": true,
          "specifyBody": "json",
          "jsonBody": "={{ { \"to\": $json.body.phone_number || $json.query.phone_number, \"message\": $json.response || $json.response_text } }}",
          "options": {}
        },
        "id": "send-sms",
        "name": "Send SMS via Twilio",
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.2,
        "position": [
          1250,
          550
        ]
      },
      {
        "parameters": {
          "conditions": {
            "string": [
              {
                "value1": "={{ $json.body.action || $json.query.action }}",
                "operation": "equals",
                "value2": "voice"
              }
            ]
          }
        },
        "id": "check-voice-action",
        "name": "Check Voice Action",
        "type": "n8n-nodes-base.if",
        "typeVersion": 2,
        "position": [
          1050,
          750
        ]
      },
      {
        "parameters": {
          "url": "http://mas-orchestrator:8000/twilio/voice/message",
          "authentication": "none",
          "sendBody": true,
          "specifyBody": "json",
          "jsonBody": "={{ { \"to\": $json.body.phone_number || $json.query.phone_number, \"message\": $json.response || $json.response_text, \"voice\": \"alice\" } }}",
          "options": {}
        },
        "id": "send-voice",
        "name": "Send Voice Message via Twilio",
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.2,
        "position": [
          1250,
          700
        ]
      },
      {
        "parameters": {
          "content": "=Zapier MCP integration available at:\nhttps://mcp.zapier.com/api/mcp/s/MmM5MmJkNDgtMDI5MC00ZGZhLWFlOGItYzM1MDQ4YTNkOWU0OmY5OWI4ZGYxLTAxNTgtNGZmOC05MDRkLTZlMmQzMzNlM2ViOQ==/mcp\n\nUse HTTP Request node to call Zapier actions.\nExample: POST with proper auth headers to trigger Zaps.",
          "height": 80,
          "width": 400,
          "color": 7
        },
        "id": "zapier-note",
        "name": "Zapier MCP Info",
        "type": "n8n-nodes-base.stickyNote",
        "typeVersion": 1,
        "position": [
          250,
          600
        ]
      },
      {
        "parameters": {
          "content": "=This workflow demonstrates:\n- Webhook trigger for external/UI calls\n- MAS agent listing\n- Orchestrator chat with context\n- n8n Data Table logging\n- Feedback loop to MAS\n- Twilio SMS/voice integration\n- Ready for Zapier MCP integration\n\nTo extend:\n1. Add HTTP Request nodes for Zapier MCP actions\n2. Add Proxmox/UniFi integration calls\n3. Add conditional routing to specific agents\n4. Add voice transcription branch\n5. Use action=sms or action=voice in webhook body to trigger Twilio",
          "height": 200,
          "width": 400,
          "color": 4
        },
        "id": "workflow-docs",
        "name": "Workflow Documentation",
        "type": "n8n-nodes-base.stickyNote",
        "typeVersion": 1,
        "position": [
          650,
          600
        ]
      }
    ],
    "connections": {
      "webhook-trigger": {
        "main": [
          [
            {
              "node": "extract-command",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "extract-command": {
        "main": [
          [
            {
              "node": "route-decision",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "route-decision": {
        "main": [
          [
            {
              "node": "list-agents",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "orchestrator-chat",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "list-agents": {
        "main": [
          [
            {
              "node": "format-response",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "orchestrator-chat": {
        "main": [
          [
            {
              "node": "format-response",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "format-response": {
        "main": [
          [
            {
              "node": "store-feedback",
              "type": "main",
              "index": 0
            },
            {
              "node": "check-sms-action",
              "type": "main",
              "index": 0
            },
            {
              "node": "check-voice-action",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "check-sms-action": {
        "main": [
          [
            {
              "node": "send-sms",
              "type": "main",
              "index": 0
            }
          ],
          []
        ]
      },
      "check-voice-action": {
        "main": [
          [
            {
              "node": "send-voice",
              "type": "main",
              "index": 0
            }
          ],
          []
        ]
      },
      "send-sms": {
        "main": [
          [
            {
              "node": "webhook-response",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "send-voice": {
        "main": [
          [
            {
              "node": "webhook-response",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "store-feedback": {
        "main": [
          [
            {
              "node": "webhook-response",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    },
    "authors": "import",
    "name": null,
    "description": null,
    "autosaved": false,
    "workflowPublishHistory": [
      {
        "createdAt": "2026-01-27T18:33:37.708Z",
        "id": 4,
        "workflowId": "ABxL2tJ7YxYox2jE",
        "versionId": "1044ae2b-0e0c-42a4-845e-9970e0b51c05",
        "event": "activated",
        "userId": "5a61112a-4aeb-40a2-a504-bd67afa8e55b"
      },
      {
        "createdAt": "2026-01-27T18:50:05.176Z",
        "id": 21,
        "workflowId": "ABxL2tJ7YxYox2jE",
        "versionId": "1044ae2b-0e0c-42a4-845e-9970e0b51c05",
        "event": "activated",
        "userId": "5a61112a-4aeb-40a2-a504-bd67afa8e55b"
      },
      {
        "createdAt": "2026-01-27T18:50:04.091Z",
        "id": 20,
        "workflowId": "ABxL2tJ7YxYox2jE",
        "versionId": "1044ae2b-0e0c-42a4-845e-9970e0b51c05",
        "event": "deactivated",
        "userId": "5a61112a-4aeb-40a2-a504-bd67afa8e55b"
      }
    ]
  }
}